webpackJsonp([54],{EkIw:function(e,t){},WKGA:function(e,t){},md9p:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),r=s("QVEk"),l=s("TNFc"),o={data:function(){return{dialogVisible:this.show,isClearFileBsyj:!1,isClearFileFwzn:!1,fwlbList:[],fwdxList:[],fwData:{},bsyjfjMc:"",fwznfjMc:"",form:{fwmc:"",fwdx:[],lxr:"",lxfs:"",sjbm:"",bsyj:"",bsyjfj:"",fwzn:"0",fwznsm:"",fwznfj:"",fwlb:"",fwnr:"",xxhzc:"0",jsnf:"",cjgs:"",jszt:"",sxsj:"",xxzxdjls:"",xxzxdjlslxfs:"",ywbmdjls:"",ywbmdjlslxfs:"",cjgsdjr:"",cjgsdjrlxfs:"",syqk:"",bz:""}}},props:{show:{type:Boolean,default:!1},Type:{type:String,default:""},wid:{type:String,default:""}},watch:{show:function(e,t){var s=this;e&&(this.getService(),"edit"==this.Type?this.$get(this.API.getServiceItem,{wid:this.wid}).then(function(e){"success"==e.state&&(s.fwData=e.data,s.form.fwmc=s.fwData.fwmc,s.form.fwdx=s.fwData.fwdxwid.split(","),s.form.lxr=s.fwData.lxr,s.form.lxfs=s.fwData.lxfs,s.form.sjbm=s.fwData.sjbm,s.form.bsyj=s.fwData.bsyj,s.bsyjfjMc=s.fwData.bsyjFj?s.fwData.bsyjFj[0].fjmc:"",s.form.bsyjfj=s.fwData.bsyjFj?s.fwData.bsyjFj[0].fjbh+"|"+s.fwData.bsyjFj[0].fjmc:"",s.form.fwzn=s.fwData.fwzn,s.form.fwznsm=s.fwData.fwznsm,s.fwznfjMc=s.fwData.fwznFj?s.fwData.fwznFj[0].fjmc:"",s.form.fwznfj=s.fwData.fwznFj?s.fwData.fwznFj[0].fjbh+"|"+s.fwData.fwznFj[0].fjmc:"",s.form.fwlb=s.fwData.fwlbwid,s.form.fwnr=s.fwData.fwnr,s.form.xxhzc=s.fwData.xxhzc,s.form.jsnf=s.fwData.jsnf,s.form.cjgs=s.fwData.cjgs,s.form.jszt=s.fwData.jszt,s.form.sxsj=s.fwData.sxsj,s.form.xxzxdjls=s.fwData.xxzxdjls,s.form.xxzxdjlslxfs=s.fwData.xxzxdjlslxfs,s.form.ywbmdjls=s.fwData.ywbmdjls,s.form.ywbmdjlslxfs=s.fwData.ywbmdjlslxfs,s.form.cjgsdjr=s.fwData.cjgsdjr,s.form.cjgsdjrlxfs=s.fwData.cjgsdjrlxfs,s.form.syqk=s.fwData.syqk,s.form.bz=s.fwData.bz,s.form.wid=s.fwData.wid)}):(delete this.form.wid,this.form.fwmc=this.form.lxr=this.form.lxfs=this.form.sjbm="",this.form.bsyj="",this.form.bsyjfj="",this.form.fwzn="0",this.form.fwznsm="",this.form.fwznfj="",this.isClearFileBsyj=!this.isClearFileBsyj,this.isClearFileFwzn=!this.isClearFileFwzn,this.form.fwlb="",this.form.fwnr="",this.form.xxhzc="0",this.form.jsnf="",this.form.cjgs="",this.form.jszt="",this.form.sxsj="",this.form.xxzxdjls="",this.form.xxzxdjlslxfs="",this.form.ywbmdjls="",this.form.ywbmdjlslxfs="",this.form.cjgsdjr="",this.form.cjgsdjrlxfs="",this.form.syqk="",this.form.bz="",this.form.fwdx=[])),this.dialogVisible=this.show}},methods:{handleUploadFileBsyj:function(e){this.form.bsyjfj=e.join(",")},handleUploadFileFwzn:function(e){this.form.fwznfj=e.join(",")},handleRemoveBsyjfj:function(){this.form.bsyjfj="",this.bsyjfjMc=""},handleRemoveFwznfj:function(){this.form.fwznfj="",this.fwznfjMc=""},getService:function(){var e=this;this.$get(this.API.serviceObjects,{}).then(function(t){"success"==t.state?e.fwdxList=t.data:e.$message({message:t.msg,type:"error"})}),this.$get(this.API.serviceCatalogs,{}).then(function(t){"success"==t.state?e.fwlbList=t.data:e.$message({message:t.msg,type:"error"})})},onSubmit:function(){this.valiDate()&&this.$emit("handleCommitService",this.form)},getServiceItem:function(){var e=this;this.$get(this.API.getServiceItem,{wid:this.wid}).then(function(t){"success"==t.state&&(e.fwData=t.data)})},valiDate:function(){return this.form.fwmc?this.form.fwdx.length?this.form.lxr?/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/.test(this.form.lxfs)&&/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.form.lxfs)?this.form.fwlb?1!=this.form.xxhzc||this.form.jsnf?1!=this.form.xxhzc||this.form.cjgs?1!=this.form.xxhzc||this.form.jszt?!(1==this.form.xxhzc&&!this.form.sxsj)||(this.$message({message:"请选择上线时间",type:"warning"}),!1):(this.$message({message:"请选择建设状态",type:"warning"}),!1):(this.$message({message:"请输入承建公司",type:"warning"}),!1):(this.$message({message:"请选择建设年份",type:"warning"}),!1):(this.$message({message:"请选择服务类别",type:"warning"}),!1):(this.$message({message:"请填写正确联系方式",type:"warning"}),!1):(this.$message({message:"请输入联系人",type:"warning"}),!1):(this.$message({message:"请选择服务对象",type:"warning"}),!1):(this.$message({message:"请填写服务名称",type:"warning"}),!1)}},components:{uploadFile:l.a}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"服务事项基本信息",visible:e.dialogVisible,"append-to-body":!0,"close-on-click-modal":!1,show:e.show,width:"1000px"},on:{"update:visible":function(t){e.dialogVisible=t},close:function(t){e.$emit("update:show",!1)}}},[s("el-form",{ref:"form",staticStyle:{padding:"10px"},attrs:{model:e.form,"label-width":"135px",size:"mini"}},[s("div",{attrs:{flex:""}},[s("el-form-item",{attrs:{label:"服务名称",required:""}},[s("el-input",{staticStyle:{width:"355px"},attrs:{placeholder:"请输入服务名称"},model:{value:e.form.fwmc,callback:function(t){e.$set(e.form,"fwmc",t)},expression:"form.fwmc"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"服务对象",required:""}},[s("el-select",{staticStyle:{width:"355px"},attrs:{multiple:"",placeholder:"请选择服务对象"},model:{value:e.form.fwdx,callback:function(t){e.$set(e.form,"fwdx",t)},expression:"form.fwdx"}},e._l(e.fwdxList,function(e,t){return s("el-option",{key:t,attrs:{label:e.text,value:e.id}})}))],1)],1),e._v(" "),s("div",{attrs:{flex:""}},[s("el-form-item",{attrs:{label:"联系人",required:""}},[s("el-input",{staticStyle:{width:"355px"},attrs:{type:"text",placeholder:"请输入联系人"},model:{value:e.form.lxr,callback:function(t){e.$set(e.form,"lxr",t)},expression:"form.lxr"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"联系方式",required:""}},[s("el-input",{staticStyle:{width:"355px"},attrs:{type:"number",placeholder:"请输入联系方式"},model:{value:e.form.lxfs,callback:function(t){e.$set(e.form,"lxfs",t)},expression:"form.lxfs"}})],1)],1),e._v(" "),s("div",{attrs:{flex:""}},[s("el-form-item",{attrs:{label:"服务类别",required:""}},[s("el-select",{staticStyle:{width:"355px"},attrs:{placeholder:"请选择服务类别"},model:{value:e.form.fwlb,callback:function(t){e.$set(e.form,"fwlb",t)},expression:"form.fwlb"}},e._l(e.fwlbList,function(e,t){return s("el-option",{key:t,attrs:{label:e.text,value:e.id}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:"涉及部门"}},[s("el-input",{staticStyle:{width:"355px"},attrs:{placeholder:"请输入涉及部门"},model:{value:e.form.sjbm,callback:function(t){e.$set(e.form,"sjbm",t)},expression:"form.sjbm"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"服务内容"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请输入服务内容"},model:{value:e.form.fwnr,callback:function(t){e.$set(e.form,"fwnr",t)},expression:"form.fwnr"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"办事依据"}},[s("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入办事依据"},model:{value:e.form.bsyj,callback:function(t){e.$set(e.form,"bsyj",t)},expression:"form.bsyj"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"办事依据附件"}},[s("uploadFile",{attrs:{istb:e.isClearFileBsyj},on:{handleUploadFile:e.handleUploadFileBsyj}}),e._v(" "),e.bsyjfjMc?s("p",{staticClass:"file"},[e._v(e._s(e.bsyjfjMc)+" "),s("i",{staticClass:"el-icon-close",on:{click:e.handleRemoveBsyjfj}})]):e._e()],1),e._v(" "),s("el-form-item",{attrs:{label:"服务指南",required:""}},[s("el-radio-group",{staticStyle:{width:"100%"},model:{value:e.form.fwzn,callback:function(t){e.$set(e.form,"fwzn",t)},expression:"form.fwzn"}},[s("el-radio",{attrs:{label:"1"}},[e._v("有")]),e._v(" "),s("el-radio",{attrs:{label:"0"}},[e._v("无")])],1)],1),e._v(" "),1==e.form.fwzn?s("el-form-item",{attrs:{label:"服务指南说明",required:""}},[s("el-input",{attrs:{type:"textarea",placeholder:"服务指南说明"},model:{value:e.form.fwznsm,callback:function(t){e.$set(e.form,"fwznsm",t)},expression:"form.fwznsm"}})],1):e._e(),e._v(" "),1==e.form.fwzn?s("el-form-item",{attrs:{label:"服务指南附件"}},[s("uploadFile",{attrs:{istb:e.isClearFileFwzn},on:{handleUploadFile:e.handleUploadFileFwzn}}),e._v(" "),e.fwznfjMc?s("p",{staticClass:"file"},[e._v(e._s(e.fwznfjMc)+" "),s("i",{staticClass:"el-icon-close",on:{click:e.handleRemoveFwznfj}})]):e._e()],1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"信息化支持",required:""}},[s("el-radio-group",{staticStyle:{width:"100%"},model:{value:e.form.xxhzc,callback:function(t){e.$set(e.form,"xxhzc",t)},expression:"form.xxhzc"}},[s("el-radio",{attrs:{label:"1"}},[e._v("有")]),e._v(" "),s("el-radio",{attrs:{label:"0"}},[e._v("无")])],1)],1),e._v(" "),1==e.form.xxhzc?s("div",[s("div",{attrs:{flex:""}},[s("el-form-item",{attrs:{label:"建设年份",required:""}},[s("el-date-picker",{staticStyle:{width:"355px"},attrs:{align:"right",type:"year",placeholder:"选择年"},model:{value:e.form.jsnf,callback:function(t){e.$set(e.form,"jsnf",t)},expression:"form.jsnf"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"承建公司",required:""}},[s("el-input",{staticStyle:{width:"355px"},attrs:{placeholder:"请输入承建公司"},model:{value:e.form.cjgs,callback:function(t){e.$set(e.form,"cjgs",t)},expression:"form.cjgs"}})],1)],1),e._v(" "),s("div",{attrs:{flex:""}},[s("el-form-item",{attrs:{label:"建设状态",required:""}},[s("el-select",{staticStyle:{width:"355px"},attrs:{placeholder:"请选择建设状态"},model:{value:e.form.jszt,callback:function(t){e.$set(e.form,"jszt",t)},expression:"form.jszt"}},[s("el-option",{attrs:{label:"在建",value:"1"}}),e._v(" "),s("el-option",{attrs:{label:"售后",value:"2"}}),e._v(" "),s("el-option",{attrs:{label:"服务",value:"3"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"上线时间",required:""}},[s("el-date-picker",{staticStyle:{width:"355px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.sxsj,callback:function(t){e.$set(e.form,"sxsj",t)},expression:"form.sxsj"}})],1)],1)]):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"使用情况"}},[s("el-input",{staticStyle:{width:"100%"},attrs:{type:"textarea",rows:"4",placeholder:"请输入使用情况"},model:{value:e.form.syqk,callback:function(t){e.$set(e.form,"syqk",t)},expression:"form.syqk"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"备注"}},[s("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"请输入备注"},model:{value:e.form.bz,callback:function(t){e.$set(e.form,"bz",t)},expression:"form.bz"}})],1),e._v(" "),s("el-form-item",{attrs:{"text-right":""}},[s("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var f=s("VU/8")(o,n,!1,function(e){s("EkIw")},"data-v-dd5765ac",null).exports,c=s("XZD3"),m={data:function(){return{jbxxShow:!1,ssjhShow:!1,Type:"",treeDataSource:[],currentPage:1,pageSize:15,records:0,tableData:[],unit:{},curDept:{},wid:"",prevTree:{}}},props:{isPlan:{type:Boolean,default:!1}},methods:{handleChangeUnit:function(e){this.curDept={},this.unit=e,this.treeDept(),this.pageServiceItem()},handleCommitSSjh:function(e){var t=this;e.zbwid=this.curData.wid,this.$post(this.API.updateServiceItemPlan,e).then(function(e){"success"==e.state?(t.pageServiceItem(),t.$message({message:"保存成功",type:"success"}),t.ssjhShow=!1):t.$message({message:e.msg,type:"error"})})},handleCommitService:function(e){var t=this,s=e;s.fwdx=e.fwdx.join(","),s.dwbh=this.unit.dwbh,s.dwmc=this.unit.dwmc,s.bmbh=this.curDept.id,s.bmmc=this.curDept.title,this.$post(this.API.saveServiceItem,s).then(function(e){"success"==e.state?(t.pageServiceItem(),t.$message({message:"添加成功",type:"success"}),t.jbxxShow=!1):t.$message({message:e.msg,type:"error"})})},handleCurrentChange:function(e){this.currentPage=e,this.pageServiceItem()},handlerExpand:function(e){e.isExpand=!e.isExpand},handlerChooseModel:function(e){"{}"!=i()(this.prevTree)&&this.$set(this.prevTree,"Experience","无"),this.$set(e,"Experience","1"),this.prevTree=e,this.curDept=e,this.currentPage=1,this.pageServiceItem()},handleAddService:function(){this.Type="",this.jbxxShow=!0},handleAddSsjh:function(e){this.$emit("handleAddSsjh",e)},handleOperate:function(e,t){"edit"==e?(this.wid=t.wid,this.Type="edit",this.jbxxShow=!0):"ssjh"==e&&(this.ssjhShow=!0)},pageServiceItem:function(){var e=this;this.$get(this.API.pageServiceItem,{curPage:this.currentPage,pageSize:this.isPlan?10:this.pageSize,dwbh:this.unit.dwbh,bmbh:this.curDept.id?this.curDept.id:""}).then(function(t){"success"==t.state&&(t.data&&t.data.rows?e.tableData=t.data.rows:e.tableData=[],e.records=t.data.records)})},treeDept:function(){var e=this;this.$get(this.API.treeDeptWithUnit,{dwbh:this.unit.dwbh,dwmc:this.unit.dwmc,zts:"1,3"}).then(function(t){"success"==t.state&&(e.treeDataSource=t.data)})}},components:{treeTable:r.a,jbxxDailog:f,chooseSchool:c.a}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pannelPadding-10"},[s("div",{staticClass:"pannelPaddingBg-10 jh-pannel "},[s("div",[s("div",{staticClass:"tree"},[s("chooseSchool",{on:{handleChangeUnit:e.handleChangeUnit}}),e._v(" "),s("tree-table",{ref:"recTree",attrs:{list:e.treeDataSource},on:{"update:list":function(t){e.treeDataSource=t},handlerExpand:e.handlerExpand,handlerChooseModel:e.handlerChooseModel}})],1),e._v(" "),s("div",{staticClass:"form"},[e.curDept.parentId?s("div",{staticStyle:{"padding-bottom":"10px"}},[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleAddService}},[e._v("添加服务事项")])],1):e._e(),e._v(" "),s("el-table",{style:{width:e.isPlan?"760px":"100%"},attrs:{data:e.tableData,border:""}},[s("el-table-column",{attrs:{fixed:"left",label:"操作",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isPlan?e._e():s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){e.handleOperate("edit",t.row)}}},[e._v("编辑")]),e._v(" "),e.isPlan?e._e():s("a",{attrs:{href:"#/schoolSeivice/detail?id="+t.row.wid,target:"_blank"}},[e._v("查看")]),e._v(" "),e.isPlan?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){e.handleAddSsjh(t.row)}}},[e._v("添加")]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"fwmc",label:"服务名称","min-width":"220"}}),e._v(" "),s("el-table-column",{attrs:{prop:"bmmc",label:"部门名称",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"bsyj",label:"办事依据",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fwdx",label:"服务对象",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fwlb",label:"服务类别",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"fwzn",label:"服务指南",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s("0"==t.row.fwzn?"无":"有"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"xxhzc",label:"信息化支持",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s("0"==t.row.xxhzc?"无":"有"))])]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.records},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)])]),e._v(" "),s("jbxxDailog",{attrs:{show:e.jbxxShow,wid:e.wid,Type:e.Type},on:{"update:show":function(t){e.jbxxShow=t},handleCommitService:e.handleCommitService}})],1)},staticRenderFns:[]};var h=s("VU/8")(m,d,!1,function(e){s("WKGA")},null,null);t.default=h.exports}});
//# sourceMappingURL=54.ca2b1f789c31595df258.js.map