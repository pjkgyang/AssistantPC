webpackJsonp([61],{W4hl:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=s("a3Yh"),a=s.n(l),i=s("oFuF"),o=s("UiN9"),n=s("9A7R"),r=s("FqQf"),c=s("NxvJ"),h=s("dAwu"),d={data:function(){return{lcbjlShow:!1,lcbbh:"",gczdList:[],checkList:[],xmlbList:[],htxzList:[],keyword:"",cnkssj:"",cnjssj:"",sjkssj:"",sjjssj:"",qygc:"",total:null,pageSize:15,currentPage:1,tableData3:[],totalWgl:"",multipleSelection:[],planVisible:!1,milestoneVisible:!1,ishownTZJH:!0,form:{startDate:"",endDate:"",sm:""},lcbbhArr:[],xmbh:"",groupTag:"",ishow:!0,sfxmjl:"",sfzrr:"",sfgx:"",filterShow:!1,htbhKeyword:"",xmbhKeyword:"",xmmcKeyword:"",xmnrKeyword:"",lcbmsKeyword:"",xmjlKeyword:"",zrrKeyword:""}},methods:{handleOpenfilter:function(){this.filterShow=!this.filterShow},handleChooseXmjl:function(){this.currentPage=1,this.queryMilestoneData()},handleChooseZrr:function(){this.currentPage=1,this.queryMilestoneData()},handleChooseSfgx:function(){this.currentPage=1,this.queryMilestoneData()},handleCheckRrecord:function(t){this.lcbbh=t.lcbbh,this.lcbjlShow=!this.lcbjlShow},handleChangeFilter:function(t){this.currentPage=1,this.queryMilestoneData()},handleCommitMilestone:function(){this.milestoneVisible=!1,this.queryMilestoneData()},checkboxInit:function(t,e){return"计划中"!=t.zt&&"处理中"!=t.zt?0:1},handleClose:function(){this.planVisible=!1},handleCommit:function(){var t=this;Object(o.a)({xmbh:"",lcbbh:this.lcbbhArr.join(","),startDate:this.form.startDate,endDate:this.form.endDate,sm:this.form.sm}).then(function(e){"success"==e.data.state&&(t.planVisible=!t.planVisible,t.$alert("修改成功","提示",{confirmButtonText:"确定",type:"success",callback:function(e){t.form.sm="",t.queryMilestoneData()}}))})},commitLcb:function(){var t=this;0!=this.multipleSelection.length?Object(o.c)({lcbbh:this.lcbbhArr.join(",")}).then(function(e){var s=e.data;"success"==s.state&&(-1==s.data.lcbType?t.$alert("不允许同时提交多个项目的整体验收里程碑！","提示",{confirmButtonText:"确定",type:"warning"}):(t.milestoneVisible=!t.milestoneVisible,t.xmbh=""))}):this.$alert("请选择里程碑","提示",{confirmButtonText:"确定",type:"warning"})},exportLcb:function(){this.cnkssj=this.cnkssj?this.cnkssj:"",this.cnjssj=this.cnjssj?this.cnjssj:"",this.sjkssj=this.sjkssj?this.sjkssj:"",this.sjjssj=this.sjjssj?this.sjjssj:"",window.open(window.baseurl+"milestone/exportMilestoneData.do?xmbh="+this.xmbhKeyword+"&keyword="+this.keyword+"&zt="+this.checkList.join(",")+"&qygc="+this.qygc+"&startCnjssj="+this.cnkssj+"&endCnjssj="+this.cnjssj+"&startSjjssj="+this.sjkssj+"&endSjjssj="+this.sjjssj+"&nrxmlb="+this.xmlbList.join(",")+"&yxmjl="+this.sfxmjl+"&yzrr="+this.sfzrr+"&htbh="+this.htbhKeyword+"&xmmc="+this.xmmcKeyword+"&xmnr="+this.xmnrKeyword+"&lcbms="+this.lcbmsKeyword+"&xmjl="+this.xmjlKeyword+"&zrr="+this.zrrKeyword+"&htxz="+this.htxzList.join(",")+"&sfgx="+this.sfgx)},handleSearchLcb:function(){this.queryMilestoneData()},searchLcbContent:function(){this.queryMilestoneData()},handleCurrentChange:function(t){this.currentPage=t,this.queryMilestoneData()},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.queryMilestoneData()},handleCheckbox:function(t){this.currentPage=1,this.queryMilestoneData()},handleXMlb:function(t){this.currentPage=1,this.queryMilestoneData()},handleHtxz:function(t){this.currentPage=1,this.queryMilestoneData()},changeCnStartDate:function(){this.currentPage=1,this.queryMilestoneData()},changeCnEndDate:function(){this.currentPage=1,this.queryMilestoneData()},changeSjStartDate:function(){this.currentPage=1,this.queryMilestoneData()},changeSjEndDate:function(){this.currentPage=1,this.queryMilestoneData()},handleSelectionChange:function(t){var e=this;this.multipleSelection=t,this.lcbbhArr=[],0!=this.multipleSelection.length?this.multipleSelection.forEach(function(t,s,l){t.lcbms.includes("整体验收")?e.ishownTZJH=!1:e.ishownTZJH=!0,e.lcbbhArr.push(t.lcbbh)}):this.ishownTZJH=!0},queryMilestoneData:function(){var t,e=this;Object(o.d)((t={curPage:this.currentPage,pageSize:this.pageSize,xmbh:"",keyword:this.keyword,qygc:this.qygc,zt:0==this.checkList.length?"":this.checkList.join(","),startCnjssj:this.cnkssj?this.cnkssj:"",endCnjssj:this.cnjssj?this.cnjssj:"",startSjjssj:this.sjkssj?this.sjkssj:"",endSjjssj:this.sjjssj?this.sjjssj:"",nrxmlb:0==this.xmlbList.length?"":this.xmlbList.join(","),yxmjl:this.sfxmjl,yzrr:this.sfzrr,htbh:this.htbhKeyword,xmmc:this.xmmcKeyword,xmnr:this.xmnrKeyword,lcbms:this.lcbmsKeyword,xmjl:this.xmjlKeyword,zrr:this.zrrKeyword},a()(t,"xmbh",this.xmbhKeyword),a()(t,"htxz",this.htxzList.join(",")),a()(t,"sfgx",this.sfgx),t)).then(function(t){var s=t.data;if("success"==s.state){e.totalWgl=s.data.totalWgl;var l=s.data.data.rows;l.forEach(function(t,e,s){s[e].wglv=Object(i.o)(t.wglv),s[e].wglg=Object(i.o)(t.wglg),t.zt="1"==t.zt?"计划中":"2"==t.zt?"处理中":"3"==t.zt?"已完成":"4"==t.zt?"停滞":"5"==t.zt?"关闭":"6"==t.zt?"取消":"7"==t.zt?"待定":"完成待确认"}),e.tableData3=l,e.total=s.data.data.records}})}},watch:{filterShow:function(t,e){t||(this.htbhKeyword=this.xmbhKeyword=this.xmmcKeyword=this.xmnrKeyword=this.lcbmsKeyword=this.xmjlKeyword=this.zrrKeyword="",this.currentPage=1,this.queryMilestoneData())}},activated:function(){this.groupTag=JSON.parse(sessionStorage.userInfo).userGroupTag,null==Object(i.m)("gczd")?Object(i.h)("gczd",this.gczdList,!0):this.gczdList=Object(i.m)("gczd"),-1!=this.groupTag.indexOf("JZGCRY")?this.ishow=!0:this.ishow=!1,this.queryMilestoneData()},components:{pagination:n.a,commitMilestone:r.a,filterComponent:c.a,lcbjlDialog:h.a}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"milestone-manage"},[s("section",{staticStyle:{"border-radius":"5px",padding:"8px 0",background:"#fff","box-shadow":"0 0 5px #ccc"}},[s("div",{staticClass:"filter"},[s("span",{staticClass:"filter-title"},[t._v("高级查询:")]),t._v(" "),s("el-input",{staticStyle:{width:"40%"},attrs:{size:"mini",placeholder:"请输入项目编号/项目名称/里程碑描述/项目内容/项目经理/责任人"},on:{change:t.searchLcbContent},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.handleOpenfilter}},[t._v(t._s(t.filterShow?"隐藏（清空）":"打开")+"高级查询条件"),s("i",{class:{"el-icon-arrow-up":!t.filterShow,"el-icon-arrow-down":t.filterShow,"el-icon--right":!0}})]),t._v("\n      　"),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleSearchLcb}},[t._v("查询")])],1),t._v(" "),s("transition",{attrs:{name:"el-zoom-in-top"}},[t.filterShow?s("div",{staticStyle:{padding:"0 20px"},attrs:{flex:"",flexwrap:""}},[s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("合同编号: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输合同编号"},on:{change:t.searchLcbContent},model:{value:t.htbhKeyword,callback:function(e){t.htbhKeyword=e},expression:"htbhKeyword"}})],1),t._v(" "),s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("项目编号: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输入项目编号"},on:{change:t.searchLcbContent},model:{value:t.xmbhKeyword,callback:function(e){t.xmbhKeyword=e},expression:"xmbhKeyword"}})],1),t._v(" "),s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("项目名称: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输入项目名称"},on:{change:t.searchLcbContent},model:{value:t.xmmcKeyword,callback:function(e){t.xmmcKeyword=e},expression:"xmmcKeyword"}})],1),t._v(" "),s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("项目内容: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输入项目内容"},on:{change:t.searchLcbContent},model:{value:t.xmnrKeyword,callback:function(e){t.xmnrKeyword=e},expression:"xmnrKeyword"}})],1),t._v(" "),s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("里程碑描述: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输入里程碑描述"},on:{change:t.searchLcbContent},model:{value:t.lcbmsKeyword,callback:function(e){t.lcbmsKeyword=e},expression:"lcbmsKeyword"}})],1),t._v(" "),s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("项目经理: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输入项目经理"},on:{change:t.searchLcbContent},model:{value:t.xmjlKeyword,callback:function(e){t.xmjlKeyword=e},expression:"xmjlKeyword"}})],1),t._v(" "),s("div",{staticClass:"filter filterFlex"},[s("span",{staticClass:"filter-title fs-12"},[t._v("责任人: ")]),t._v(" "),s("el-input",{staticStyle:{width:"calc(100% - 120px)"},attrs:{size:"mini",placeholder:"请输入责任人"},on:{change:t.searchLcbContent},model:{value:t.zrrKeyword,callback:function(e){t.zrrKeyword=e},expression:"zrrKeyword"}})],1)]):t._e()]),t._v(" "),s("div",{staticClass:"filter colcenter milestone-filter"},[s("span",{staticClass:"filter-title"},[t._v("区域工程:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:t.handleChangeFilter},model:{value:t.qygc,callback:function(e){t.qygc=e},expression:"qygc"}},t._l(t.gczdList,function(t){return s("el-option",{key:t.label,attrs:{label:t.mc,value:t.label}})})),t._v("　　\n      "),s("span",[s("span",{staticClass:"filter-weight"},[t._v("是否有项目经理:")]),t._v(" "),s("el-radio-group",{on:{change:t.handleChooseXmjl},model:{value:t.sfxmjl,callback:function(e){t.sfxmjl=e},expression:"sfxmjl"}},[s("el-radio",{attrs:{label:""}},[t._v("全部")]),t._v(" "),s("el-radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),s("el-radio",{attrs:{label:"0"}},[t._v("否")])],1)],1),t._v(" "),s("span",[t._v("　　\n        "),s("span",{staticClass:"filter-weight"},[t._v("是否有责任人:")]),t._v(" "),s("el-radio-group",{on:{change:t.handleChooseZrr},model:{value:t.sfzrr,callback:function(e){t.sfzrr=e},expression:"sfzrr"}},[s("el-radio",{attrs:{label:""}},[t._v("全部")]),t._v(" "),s("el-radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),s("el-radio",{attrs:{label:"0"}},[t._v("否")])],1)],1)],1),t._v(" "),s("div",{staticClass:"filter",attrs:{flex:""}},[s("span",{staticClass:"filter-title"},[t._v("里程碑状态:")]),t._v(" "),s("el-checkbox-group",{on:{change:t.handleCheckbox},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[s("el-checkbox",{attrs:{label:"1"}},[t._v("计划中")]),t._v(" "),s("el-checkbox",{attrs:{label:"2"}},[t._v("处理中")]),t._v(" "),s("el-checkbox",{attrs:{label:"3"}},[t._v("已完成")]),t._v(" "),s("el-checkbox",{attrs:{label:"4"}},[t._v("停滞")]),t._v(" "),s("el-checkbox",{attrs:{label:"5"}},[t._v("关闭")]),t._v(" "),s("el-checkbox",{attrs:{label:"6"}},[t._v("取消")]),t._v(" "),s("el-checkbox",{attrs:{label:"7"}},[t._v("待定")]),t._v(" "),s("el-checkbox",{attrs:{label:"9"}},[t._v("完成待确认")])],1)],1),t._v(" "),s("div",{staticClass:"filter",attrs:{flex:""}},[s("span",{staticClass:"filter-title"},[t._v("项目类别:")]),t._v(" "),s("el-checkbox-group",{on:{change:t.handleXMlb},model:{value:t.xmlbList,callback:function(e){t.xmlbList=e},expression:"xmlbList"}},[s("el-checkbox",{attrs:{label:"软件"}},[t._v("软件")]),t._v(" "),s("el-checkbox",{attrs:{label:"集成"}},[t._v("集成")]),t._v(" "),s("el-checkbox",{attrs:{label:"软件服务"}},[t._v("软件服务")]),t._v(" "),s("el-checkbox",{attrs:{label:"集成服务"}},[t._v("集成服务")])],1)],1),t._v(" "),s("div",{staticClass:"filter milestone-filter",attrs:{flex:""}},[s("span",{staticClass:"filter-title"},[t._v("合同性质:")]),t._v(" "),s("el-checkbox-group",{on:{change:t.handleHtxz},model:{value:t.htxzList,callback:function(e){t.htxzList=e},expression:"htxzList"}},[s("el-checkbox",{attrs:{label:"A"}},[t._v("A类")]),t._v(" "),s("el-checkbox",{attrs:{label:"B"}},[t._v("B类")]),t._v(" "),s("el-checkbox",{attrs:{label:"C"}},[t._v("C类")])],1),t._v("　　\n      "),t._v(" "),s("span",[s("span",{staticClass:"filter-weight"},[t._v("是否购销:")]),t._v(" "),s("el-radio-group",{on:{change:t.handleChooseSfgx},model:{value:t.sfgx,callback:function(e){t.sfgx=e},expression:"sfgx"}},[s("el-radio",{attrs:{label:""}},[t._v("全部")]),t._v(" "),s("el-radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),s("el-radio",{attrs:{label:"0"}},[t._v("否")])],1)],1)],1),t._v(" "),s("div",{staticClass:"filter"},[s("span",{staticClass:"filter-title"},[t._v("承诺结束时间")]),t._v(" "),s("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"开始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:t.changeCnStartDate},model:{value:t.cnkssj,callback:function(e){t.cnkssj=e},expression:"cnkssj"}}),t._v("\n       至 \n      "),s("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:t.changeCnEndDate},model:{value:t.cnjssj,callback:function(e){t.cnjssj=e},expression:"cnjssj"}})],1),t._v(" "),s("div",{staticClass:"filter"},[s("span",{staticClass:"filter-title"},[t._v("实际结束时间")]),t._v(" "),s("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"开始日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:t.changeSjStartDate},model:{value:t.sjkssj,callback:function(e){t.sjkssj=e},expression:"sjkssj"}}),t._v("\n       至 \n      "),s("el-date-picker",{attrs:{type:"date",size:"small",placeholder:"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{change:t.changeSjEndDate},model:{value:t.sjjssj,callback:function(e){t.sjjssj=e},expression:"sjjssj"}})],1)],1),t._v(" "),s("section",{staticClass:"milestone_tabel"},[s("div",{staticStyle:{padding:"0 10px 10px"}},[t.ishow?s("p",{staticStyle:{margin:"10px 0 !important"}},[s("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.commitLcb}},[t._v("提报里程碑")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.exportLcb}},[t._v("导出")]),t._v(" "),s("span",{staticStyle:{float:"right","margin-top":"5px"}},[s("span",{staticClass:"filter-weight"},[t._v("合计完工量 : ")]),s("span",{staticStyle:{color:"#f00","font-size":"18px"}},[t._v(t._s(t.totalWgl<1e4?t.totalWgl:t.totalWgl<1e8?(t.totalWgl/1e4).toFixed(4):(t.totalWgl/1e8).toFixed(4))+" ")]),t._v(t._s(t.totalWgl<1e4?"元":t.totalWgl<1e8?"万元":"亿"))])],1):t._e(),s("p",{staticStyle:{color:"#aaa","font-size":"12px"}},[t._v("说明：整体验收里程碑不允许调整，非整体验收里程碑里程碑调整需要用户确认后才生效\n      ")]),t._v(" "),s("p"),t._v(" "),s("el-table",{ref:"multipleTable",attrs:{data:t.tableData3,border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[t.ishow?s("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.checkboxInit}}):t._e(),t._v(" "),s("el-table-column",{attrs:{prop:"qygc","min-width":"130",label:"区域工程","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"htbh","min-width":"150",label:"合同编号","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"xmbh","min-width":"100",label:"项目编号","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"xmmc","min-width":"200",label:"项目名称","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"sfzt","min-width":"100",label:"是否在谈","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"sfgx","min-width":"100",label:"是否购销","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"dkl","min-width":"100",label:"到款率","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"xmnr_display","min-width":"260",label:"项目内容","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{staticStyle:{"text-align":"left"},attrs:{prop:"lcbms_display","min-width":"260",label:"里程碑描述","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"nrxmlb","min-width":"90",label:"项目类别","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{sortable:"",label:"里程碑状态",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"name-wrapper"},["关闭"==e.row.zt?s("el-tag",{attrs:{size:"small",title:"点击查看操作详情",type:"success"},nativeOn:{click:function(s){t.handleCheckRrecord(e.row)}}},[t._v(t._s(e.row.zt))]):t._e(),t._v(" "),"关闭"!=e.row.zt?s("el-tag",{attrs:{size:"small",title:"点击查看操作详情",type:"danger"},nativeOn:{click:function(s){t.handleCheckRrecord(e.row)}}},[t._v(t._s(e.row.zt))]):t._e()],1)]}}])}),t._v(" "),t.ishow?s("el-table-column",{attrs:{prop:"wglv",label:"完工率(%)",width:"100","show-overflow-tooltip":""}}):t._e(),t._v(" "),t.ishow?s("el-table-column",{attrs:{prop:"wglg",label:"完工量(元)",width:"100"}}):t._e(),t._v(" "),s("el-table-column",{attrs:{prop:"cnjssj",sortable:"",label:"承诺结束时间",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{prop:"sjjssj",sortable:"",label:"实际结束时间",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{prop:"dwmc","min-width":"200",label:"学校名称","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"yfzrrxm","min-width":"100",label:"项目经理","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"zzrxm",label:"责任人",width:"100"}})],1)],1),t._v(" "),s("div",{staticStyle:{padding:"5px 0","text-align":"right"}},[s("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[15,35,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),s("el-dialog",{attrs:{title:"提报里程碑","close-on-click-modal":!1,visible:t.milestoneVisible,width:"600px",top:"50px"},on:{"update:visible":function(e){t.milestoneVisible=e}}},[s("commitMilestone",{attrs:{shown:t.milestoneVisible,xmbh:t.xmbh,taskLcbbhArr:t.lcbbhArr},on:{handleCommitMilestone:t.handleCommitMilestone}})],1),t._v(" "),s("lcbjlDialog",{attrs:{show:t.lcbjlShow,lcbbh:t.lcbbh},on:{"update:show":function(e){t.lcbjlShow=e}}})],1)},staticRenderFns:[]};var m=s("Z0/y")(d,b,!1,function(t){s("ov7J")},"data-v-3202b0f9",null);e.default=m.exports},ov7J:function(t,e){}});
//# sourceMappingURL=61.b0bbb3bd9e488f534815.js.map