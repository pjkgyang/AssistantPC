webpackJsonp([44],{N2Gg:function(t,a,e){"use strict";var s=e("mvHQ"),i=e.n(s),r=e("TSLv"),l=e("XYo/"),n=e("TNFc"),o={data:function(){return{visible:this.show,userShow:!1,tbly:"",userData:[],userList:[],ywyData:[],ssfyTotal:0,ywxArr:[],ekfyTotal:0,kbfyTotal:0,ssfyTotalkm:0,ekfyTotalkm:0,kbfyTotalkm:0,fileList:[],tbxx:{},fbxx:{},fileName:"",userInfo:{},userYwyData:[],istbMark:!1}},props:{show:{type:Boolean,default:!1},fbbh:{type:String,default:""},tbbh:{type:String,default:""},zbedite:{type:String,default:""},type:{type:String,default:"tb"},title:{type:String,default:""}},methods:{handleAddUser:function(){this.userShow=!0},addUserSuccess:function(t){var a=this,e=!1;if(this.userData.length){if(this.userData.forEach(function(s){s.usercode==t.usercode&&(e=!0,a.$message({message:"该用户已添加~",type:"warning"}))}),e)return;this.userData.push(t)}else this.userData.push(t)},hanldeDelete:function(t){var a=this;this.ywyData.forEach(function(e,s,i){e.zrrbh==a.userData[t].usercode&&(a.$set(a.ywyData[s],"zrrbh",""),a.$set(a.ywyData[s],"zrrxm",""),a.ssfyTotalkm=a.ssfyTotalkm-a.ywyData[s].ssfy,a.ekfyTotalkm=a.ekfyTotalkm-a.ywyData[s].ekfy,a.kbfyTotalkm=a.kbfyTotalkm-a.ywyData[s].kbfy,a.$set(a.ywyData[s],"ssfy",0),a.$set(a.ywyData[s],"ekfy",0),a.$set(a.ywyData[s],"kbfy",0))}),this.userData.splice(t,1)},handleUploadFile:function(t){this.fileList=t},handleSeleteUser:function(t){var a=this;this.ssfyTotalkm=this.ekfyTotalkm=this.kbfyTotalkm=0;var e="";this.userData.forEach(function(s,i,r){a.userData[i].ssfy=a.userData[i].ekfy=a.userData[i].kbfy=0,a.$set(a.userData[i],"ywx",""),a.userYwyData[i]=[],t==s.usercode&&(e=s.username),a.ywyData.forEach(function(r,l,n){t==r.zrrbh&&(a.ywyData[l].zrrxm=e),s.usercode==r.zrrbh&&(a.userYwyData[i].includes(r.ywymc)||a.userYwyData[i].push(r.ywymc),a.userData[i].ssfy+=Number(r.ssfy),a.userData[i].ekfy+=Number(r.ekfy),a.userData[i].kbfy+=Number(r.kbfy),a.$set(a.userData[i],"ywx",a.userYwyData[i].join(",")))}),a.ssfyTotalkm+=a.userData[i].ssfy,a.ekfyTotalkm+=a.userData[i].ekfy,a.kbfyTotalkm+=a.userData[i].kbfy})},handleChangefy:function(t,a,e){var s=this;if(this.ywyData[t].zrrbh)switch(a){case"ss":this.ssfyTotal=0,this.ssfyTotalkm=0,this.ywyData.forEach(function(t){t.zrrbh==e&&(s.ssfyTotal+=Number(t.ssfy))}),this.userData.forEach(function(t,a,i){t.usercode==e&&s.$set(s.userData[a],"ssfy",s.ssfyTotal),s.ssfyTotalkm+=s.userData[a].ssfy?s.userData[a].ssfy:0});break;case"ek":this.ekfyTotal=0,this.ekfyTotalkm=0,this.ywyData.forEach(function(t){t.zrrbh==e&&(s.ekfyTotal+=Number(t.ekfy))}),this.userData.forEach(function(t,a,i){t.usercode==e&&s.$set(s.userData[a],"ekfy",s.ekfyTotal),s.ekfyTotalkm+=s.userData[a].ekfy?s.userData[a].ekfy:0});break;case"kb":this.kbfyTotal=0,this.kbfyTotalkm=0,this.ywyData.forEach(function(t){t.zrrbh==e&&(s.kbfyTotal+=Number(t.kbfy))}),this.userData.forEach(function(t,a,i){t.usercode==e&&s.$set(s.userData[a],"kbfy",s.kbfyTotal),s.kbfyTotalkm+=s.userData[a].kbfy?s.userData[a].kbfy:0})}else this.$alert("请先选择责任人"," 提示",{type:"warning",confirmButtonText:"确定"})},handleDeleteFile:function(){this.fileName="",this.fileList=[]},handleCommit:function(){var t=this,a=[],e=!1;this.ywyData.forEach(function(t){t.zrrbh||(e=!0),a.push({htnrwid:t.htnrwid,zrrbh:t.zrrbh,zrrxm:t.zrrxm,ssfy:t.ssfy,ekfy:t.ekfy,kbfy:t.kbfy})}),e?this.$message({message:"请先选择所属责任人~",type:"warning"}):this.$post(this.API.saveTbxx,{wid:this.tbxx.wid?this.tbxx.wid:"",fbbh:this.$route.query.fbbh,tbly:this.tbly,fjwid:this.fileList.length?this.fileList.join(",").split("|")[0]:"",ssfy:this.ssfyTotalkm,ekfy:this.ekfyTotalkm,kbfy:this.kbfyTotalkm,tbtdlist:i()(a),zbedite:this.zbedite}).then(function(a){"success"==a.state?(t.$message({message:"投标成功",type:"success"}),t.istbMark=!t.istbMark,t.$emit("handleCommitToubiao","")):t.$message({message:a.msg,type:"error"})})},getTbxq:function(){var t=this;Object(r.c)({fbbh:this.fbbh,tbbh:this.tbbh}).then(function(a){var e=a.data;"success"==e.state&&(t.ywyData=e.data.htnrfy?e.data.htnrfy:[],t.tbxx=e.data.tbxx?e.data.tbxx:{},t.fbxx=e.data.fbxx,e.data.tbxx&&(t.ssfyTotalkm=e.data.tbxx.ssfy,t.ekfyTotalkm=e.data.tbxx.ekfy,t.kbfyTotalkm=e.data.tbxx.kbfy,t.tbly=e.data.tbxx.tbly),e.data.fjmc&&(t.fileName=e.data.fjmc,t.fileList.push(e.data.tbxx.fjwid)),e.data.tdfy&&e.data.tdfy.forEach(function(a,e,s){t.userList.push({username:a.zrrxm,usercode:a.zrrbh,ywx:a.ywymc,ssfy:a.ssfy,ekfy:a.ekfy,kbfy:a.kbfy})}),t.userData=t.userList,t.userData.forEach(function(a,e,s){t.userYwyData[e]=[]}))})}},watch:{show:function(t,a){this.visible=this.show,t&&(this.userInfo=JSON.parse(sessionStorage.getItem("userInfo")),this.userList=[],"tb"==this.type&&this.userList.push({username:this.userInfo.nickName,usercode:this.userInfo.userName,ywx:"",ssfy:"",ekfy:"",kbfy:""}),"edit"==this.type&&(this.fileList=[]),this.getTbxq())}},components:{userDialog:l.a,uploadComponent:n.a}},f={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-dialog",{attrs:{title:t.title,width:"1000px",top:"30px",visible:t.visible,"append-to-body":!0,"close-on-click-modal":!1,show:t.show},on:{"update:visible":function(a){t.visible=a},close:function(a){t.$emit("update:show",!1)}}},[e("div",{staticClass:"dialog-pj"},[e("div",{staticStyle:{padding:"0 20px"}},[e("div",{staticStyle:{margin:"10px 0",position:"relative"}},[e("span",{staticClass:"filter-weight"},[t._v("投标说明：")]),t._v(" "),e("el-input",{attrs:{type:"textarea",maxlength:"200",resize:"none",rows:"3"},model:{value:t.tbly,callback:function(a){t.tbly=a},expression:"tbly"}}),t._v(" "),e("span",{staticStyle:{position:"absolute",bottom:"0",right:"10px","font-size":"12px"}},[e("span",{class:{"max-length":!!t.tbly&&t.tbly.length>=200}},[t._v("( "+t._s(t.tbly?t.tbly.length:0))]),t._v("\n            / 200 )\n          ")])],1),t._v(" "),e("div",[e("span",{staticClass:"filter-weight"},[t._v("分包费用：")]),t._v(" "),e("table",{staticClass:"tb-table tdfp-table",attrs:{border:"",width:"100%"}},[e("tr",[e("th",[t._v("总金额（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxx.zfy))]),t._v(" "),e("th",[t._v("实施费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxx.ssfy))])]),t._v(" "),e("tr",[e("th",[t._v("二开费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxx.ekfy))]),t._v(" "),e("th",[t._v("可变费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxx.kbfy))])])])]),t._v(" "),e("div",[e("span",{staticClass:"filter-weight"},[t._v("投标费用：")]),t._v(" "),e("table",{staticClass:"tb-table tdfp-table",attrs:{border:"",width:"100%"}},[e("tr",[e("th",[t._v("总金额（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(Number(t.ssfyTotalkm)+Number(t.ekfyTotalkm)+Number(t.kbfyTotalkm)))]),t._v(" "),e("th",[t._v("实施费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.ssfyTotalkm))])]),t._v(" "),e("tr",[e("th",[t._v("二开费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.ekfyTotalkm))]),t._v(" "),e("th",[t._v("可变费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.kbfyTotalkm))])])])]),t._v(" "),e("br"),t._v(" "),e("div",[e("span",{staticClass:"filter-weight"},[t._v("团队成员：")]),t._v(" "),e("div",{staticStyle:{margin:"10px 0"}},[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleAddUser}},[t._v("添加成员")])],1),t._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.userData,border:""}},[e("el-table-column",{attrs:{fixed:"left",label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.hanldeDelete(a.$index)}}},[t._v("删除")])]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"usercode",label:"工号",width:"100"}}),t._v(" "),e("el-table-column",{attrs:{prop:"username",label:"姓名",width:"100"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ywx",label:"负责业务线"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ssfy",label:"分配实施金额"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ekfy",label:"分配二开金额"}}),t._v(" "),e("el-table-column",{attrs:{prop:"kbfy",label:"分配可变金额"}})],1)],1),t._v(" "),e("div",[e("span",{staticClass:"filter-weight",staticStyle:{margin:"10px 0"}},[t._v("团队分配：")]),t._v(" "),e("table",{staticClass:"tb-table tdfp-table",attrs:{width:"100%"}},[e("tr",[e("th",[t._v("业务域")]),t._v(" "),e("th",[t._v("合同内容")]),t._v(" "),e("th",[t._v("占比")]),t._v(" "),e("th",[t._v("说明")]),t._v(" "),e("th",[t._v("项目类别")]),t._v(" "),e("th",[t._v("责任人")]),t._v(" "),e("th",[t._v("实施金额")]),t._v(" "),e("th",[t._v("二开金额")]),t._v(" "),e("th",[t._v("可变金额")])]),t._v(" "),t.ywyData.length?t._e():e("tr",[e("td",{staticStyle:{color:"#909399",padding:"15px 0 !important"},attrs:{colspan:"9"}},[t._v("暂无数据")])]),t._v(" "),t._l(t.ywyData,function(a,s){return e("tr",{key:s},[e("td",[t._v(t._s(a.ywymc))]),t._v(" "),e("td",[t._v(t._s(a.cpmc))]),t._v(" "),e("td",[t._v(t._s(a.zb))]),t._v(" "),e("td",[t._v(t._s(a.htsm))]),t._v(" "),e("td",[t._v(t._s(a.xmlb))]),t._v(" "),e("td",{staticStyle:{position:"relative"},attrs:{width:"100px"}},[e("el-select",{staticStyle:{border:"none"},attrs:{size:"mini",placeholder:"请选择"},on:{change:t.handleSeleteUser},model:{value:a.zrrbh,callback:function(e){t.$set(a,"zrrbh",e)},expression:"item.zrrbh"}},t._l(t.userData,function(t,a){return e("el-option",{key:a,attrs:{label:t.username,value:t.usercode}})}))],1),t._v(" "),e("td",{attrs:{width:"80px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.ssfy,expression:"item.ssfy"}],attrs:{type:"number"},domProps:{value:a.ssfy},on:{input:[function(e){e.target.composing||t.$set(a,"ssfy",e.target.value)},function(e){t.handleChangefy(s,"ss",a.zrrbh)}]}})]),t._v(" "),e("td",{attrs:{width:"80px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.ekfy,expression:"item.ekfy"}],attrs:{type:"number"},domProps:{value:a.ekfy},on:{input:[function(e){e.target.composing||t.$set(a,"ekfy",e.target.value)},function(e){t.handleChangefy(s,"ek",a.zrrbh)}]}})]),t._v(" "),e("td",{attrs:{width:"80px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.kbfy,expression:"item.kbfy"}],attrs:{type:"number"},domProps:{value:a.kbfy},on:{input:[function(e){e.target.composing||t.$set(a,"kbfy",e.target.value)},function(e){t.handleChangefy(s,"kb",a.zrrbh)}]}})])])})],2),t._v(" "),e("br"),t._v(" "),e("div",[e("span",{staticClass:"filter-weight",staticStyle:{margin:"10px 0"}},[t._v("项目文件：")]),t._v(" "),e("uploadComponent",{attrs:{istb:t.istbMark},on:{handleUploadFile:t.handleUploadFile}}),t._v(" "),t.fileName?e("p",{staticClass:"upload_file-p",attrs:{flex:"",colcenter:"",spacebetween:""}},[e("span",[t._v(t._s(t.fileName))]),t._v(" "),e("i",{staticClass:"el-icon-close",on:{click:t.handleDeleteFile}})]):t._e()],1)])]),t._v(" "),e("div",{staticStyle:{margin:"10px 0","text-align":"right",padding:"10px 20px"}},[e("button",{staticClass:"tbcommit",on:{click:t.handleCommit}},[t._v("提交")])])])]),t._v(" "),e("userDialog",{attrs:{show:t.userShow,isdept:!1},on:{"update:show":function(a){t.userShow=a},addUserSuccess:t.addUserSuccess}})],1)},staticRenderFns:[]};var h=e("VU/8")(o,f,!1,function(t){e("qlGS")},"data-v-979c274c",null);a.a=h.exports},PcrY:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("N2Gg"),i=e("TSLv"),r={data:function(){return{toubiaoShow:!1,tbxxData:{},fbxxData:{},userData:[],ywyData:[],fjmc:"",baseUrl:"",curType:"edit"}},methods:{handleChangeZbxx:function(){this.toubiaoShow=!0},handleCommitToubiao:function(){this.toubiaoShow=!1,this.getTbxq()},getTbxq:function(){var t=this,a=[];Object(i.c)({fbbh:this.$route.query.fbbh,tbbh:this.$route.query.tbbh}).then(function(e){var s=e.data;"success"==s.state&&(t.ywyData=s.data.htnrfy?s.data.htnrfy:[],t.fbxxData=s.data.fbxx?s.data.fbxx:{},t.fjmc=s.data.fjmc,s.data.tbxx&&(t.tbxxData=s.data.tbxx),s.data.tdfy&&(s.data.tdfy.forEach(function(t,e,s){a.push({username:t.zrrxm,usercode:t.zrrbh,ywx:t.ywymc,ssfy:t.ssfy,ekfy:t.ekfy,kbfy:t.kbfy})}),t.userData=a))})}},mounted:function(){this.baseUrl=window.baseurl,this.getTbxq()},components:{toubiaoDialog:s.a}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{padding:"20px"}},[e("div",{staticClass:"pannelPaddingBg-10"},[e("h4",{staticClass:"filter-weight",attrs:{"text-center":""}},[t._v("["+t._s(t.$route.query.xmmc)+"] 中标详情")]),t._v(" "),1==t.tbxxData.zbedite?e("div",{staticClass:"mg-12",attrs:{"text-right":""}},[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleChangeZbxx}},[t._v("修改中标信息")])],1):t._e(),t._v(" "),e("div",[e("p",[e("span",{staticClass:"filter-weight tips"},[t._v("投标说明：")]),t._v("\n        "+t._s(t.tbxxData.tbly)+"\n      ")])]),t._v(" "),e("div",[t._m(0),t._v(" "),e("table",{staticClass:"tb-table",attrs:{border:"",width:"100%"}},[e("tr",[e("th",[t._v("总金额（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxxData.zfy))]),t._v(" "),e("th",[t._v("实施费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxxData.ssfy))])]),t._v(" "),e("tr",[e("th",[t._v("二开费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxxData.ekfy))]),t._v(" "),e("th",[t._v("可变费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.fbxxData.kbfy))])])])]),t._v(" "),e("div",[t._m(1),t._v(" "),e("table",{staticClass:"tb-table",attrs:{border:"",width:"100%"}},[e("tr",[e("th",[t._v("总金额（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.tbxxData.zfy))]),t._v(" "),e("th",[t._v("实施费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.tbxxData.ssfy))])]),t._v(" "),e("tr",[e("th",[t._v("二开费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.tbxxData.ekfy))]),t._v(" "),e("th",[t._v("可变费用（元）")]),t._v(" "),e("td",{attrs:{width:"30%"}},[t._v(t._s(t.tbxxData.kbfy))])])])]),t._v(" "),e("br"),t._v(" "),e("div",[e("span",{staticClass:"filter-weight tips"},[t._v("团队成员：")]),t._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.userData,border:""}},[e("el-table-column",{attrs:{prop:"usercode",label:"工号",width:"100"}}),t._v(" "),e("el-table-column",{attrs:{prop:"username",label:"姓名",width:"100"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ywx",label:"负责业务线"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ssfy",label:"分配实施金额"}}),t._v(" "),e("el-table-column",{attrs:{prop:"ekfy",label:"分配二开金额"}}),t._v(" "),e("el-table-column",{attrs:{prop:"kbfy",label:"分配可变金额"}})],1)],1),t._v(" "),e("div",[e("span",{staticClass:"filter-weight tips",staticStyle:{margin:"10px 0"}},[t._v("团队分配：")]),t._v(" "),e("table",{staticClass:"tb-table tdfp-table",attrs:{width:"100%"}},[t._m(2),t._v(" "),t.ywyData.length&&t.ywyData?t._e():e("tr",[e("td",{staticStyle:{color:"#909399",padding:"15px 0 !important"},attrs:{colspan:"9"}},[t._v("暂无数据")])]),t._v(" "),t._l(t.ywyData,function(a,s){return e("tr",{key:s},[e("td",[t._v(t._s(a.ywymc))]),t._v(" "),e("td",[t._v(t._s(a.cpmc))]),t._v(" "),e("td",[t._v(t._s(a.zb))]),t._v(" "),e("td",[t._v(t._s(a.htsm))]),t._v(" "),e("td",[t._v(t._s(a.xmlb))]),t._v(" "),e("td",{staticStyle:{position:"relative"},attrs:{width:"100px"}},[t._v(t._s(a.zrrxm))]),t._v(" "),e("td",{attrs:{width:"80px"}},[t._v(t._s(a.ssfy))]),t._v(" "),e("td",{attrs:{width:"80px"}},[t._v(t._s(a.ekfy))]),t._v(" "),e("td",{attrs:{width:"80px"}},[t._v(t._s(a.kbfy))])])})],2)]),t._v(" "),e("div",[e("span",{staticClass:"filter-weight tips",staticStyle:{margin:"10px 0"}},[t._v("相关附件：")]),t._v(" "),e("p",[t.fjmc?e("a",{attrs:{href:t.baseUrl+"attachment/downloadFile.do?fjId="+t.tbxxData.fjwid,target:"blank"}},[t._v(t._s(t.fjmc))]):e("span",[t._v("暂无附件")])])])]),t._v(" "),e("toubiaoDialog",{attrs:{show:t.toubiaoShow,title:"编辑投标信息",zbedite:"1",type:t.curType,fbbh:t.$route.query.fbbh,tbbh:t.$route.query.tbbh},on:{"update:show":function(a){t.toubiaoShow=a},handleCommitToubiao:t.handleCommitToubiao}})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("p",[a("span",{staticClass:"filter-weight tips"},[this._v("分包费用：")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[a("span",{staticClass:"filter-weight tips"},[this._v("投标费用：")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("tr",[e("th",[t._v("业务域")]),t._v(" "),e("th",[t._v("合同内容")]),t._v(" "),e("th",[t._v("占比")]),t._v(" "),e("th",[t._v("说明")]),t._v(" "),e("th",[t._v("项目类别")]),t._v(" "),e("th",[t._v("责任人")]),t._v(" "),e("th",[t._v("实施金额")]),t._v(" "),e("th",[t._v("二开金额")]),t._v(" "),e("th",[t._v("可变金额")])])}]};var n=e("VU/8")(r,l,!1,function(t){e("aaYh")},"data-v-10c82456",null);a.default=n.exports},aaYh:function(t,a){},qlGS:function(t,a){}});
//# sourceMappingURL=44.879e5380c138369521fc.js.map