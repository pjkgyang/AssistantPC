webpackJsonp([24],{XOpp:function(t,e,s){"use strict";(function(t){var a=s("mtWM"),i=(s.n(a),s("nfA5")),o=s("TNFc"),n=s("IfOk");e.a={data:function(){return{dialogQuestionVisible:!1,visible:!1,isClearFile:!1,xmInfo:{},formData:{xmmc:"",xmbh:"",tzrq:"",fjData:"",sm:""}}},props:{show:{type:Boolean,default:!1},type:{type:String,default:""},xmData:{type:Object,default:function(){return{}}}},methods:{handleEdit:function(t){this.xmInfo=t,this.formData.xmmc=t.xmmc,this.formData.xmbh=t.xmbh,this.dialogQuestionVisible=!1},addQuestiontItem:function(){this.dialogQuestionVisible=!0},handleCommit:function(){this.formData.sm=t("#summernote").summernote("code"),this.validate()&&this.$emit("handleCommit",this.formData)},handleCancel:function(){this.visible=!1,t("#summernote").summernote("code",""),this.formData.sm="",this.formData.xmmc="",this.formData.tzrq=""},handleUploadFile:function(t){this.formData.fjData=t.join(",")},validate:function(){return this.formData.xmmc?this.formData.tzrq||"tz"!=this.type?!("<p><br></p>"==this.formData.sm||!/[\u4e00-\u9fa5]/.test(this.formData.sm))||(this.$message({message:"请填写正确停滞说明",type:"warning"}),!1):(this.$message({message:"请选择停滞日期",type:"warning"}),!1):(this.$message({message:"请选择项目",type:"warning"}),!1)}},watch:{show:function(){var e=this;this.visible=this.show,this.show?(this.$nextTick(function(){t("#summernote").summernote({dialogsInBody:!0,placeholder:"请输入内容",focus:!0,height:200,width:"100%",minHeight:260,lang:"zh-CN",toolbar:[["style",["bold","italic","underline","clear"]],["font",["strikethrough","superscript","subscript"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["picture"],["link",["linkDialogShow","unlink"]]]})}),this.xmData.xmbh?(this.formData.xmbh=this.xmData.xmbh,this.formData.xmmc=this.xmData.xmmc,Object(n.q)({xmbh:this.xmData.xmbh}).then(function(t){"success"==t.data.state&&(e.xmInfo=t.data.data)})):(this.xmInfo={},this.formData.xmbh="",this.formData.xmmc="")):(t("#summernote").summernote("destroy"),this.isClearFile=!this.isClearFile)}},components:{itemChoose:i.a,uploadFile:o.a}}}).call(e,s("7t+N"))},XYEa:function(t,e,s){"use strict";var a=s("XOpp"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dialog-container xmtz_info"},[s("el-dialog",{attrs:{title:"tz"==t.type?"停滞申请":"停滞重启",width:"1100px",top:"30px",visible:t.visible,"close-on-click-modal":!1,show:t.show},on:{"update:visible":function(e){t.visible=e},close:function(e){t.$emit("update:show",!1)}}},[s("div",{staticClass:"Question pd-10"},[s("table",[s("tr",[s("th",{staticClass:"before-require"},[t._v("选择项目")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[s("el-input",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"text",readonly:"",placeholder:"请选择项目"},model:{value:t.formData.xmmc,callback:function(e){t.$set(t.formData,"xmmc",e)},expression:"formData.xmmc"}},[t.xmData.xmbh?t._e():s("el-button",{staticStyle:{width:"30px",padding:"0 12px"},attrs:{slot:"append",icon:"el-icon-circle-plus-outline"},on:{click:t.addQuestiontItem},slot:"append"})],1)],1)]),t._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:!!t.formData.xmmc,expression:"!!formData.xmmc"}]},[s("th",[t._v("项目状态")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmzt))]),t._v(" "),s("th",[t._v("学校")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.dwmc||t.xmInfo.yh||t.xmInfo.xx))])]),t._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:!!t.formData.xmmc,expression:"!!formData.xmmc"}]},[s("th",[t._v("项目类别")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmlb))]),t._v(" "),s("th",[t._v("甲方责任人")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.jfzrrxm?t.xmInfo.jfzrrxm:"无"))])]),t._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:!!t.formData.xmmc,expression:"!!formData.xmmc"}]},[s("th",[t._v("项目经理")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.yfzrrxm||t.xmInfo.xmjl))]),t._v(" "),s("th",[t._v("客户经理")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.khjl))])]),t._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:!!t.formData.xmmc,expression:"!!formData.xmmc"}]},[s("th",[t._v("签署日期")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.qssj))]),t._v(" "),s("th",[t._v("启动日期")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.qdrq))])]),t._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:!!t.formData.xmmc,expression:"!!formData.xmmc"}]},[s("th",[t._v("服务开始日期")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.fwksrq))]),t._v(" "),s("th",[t._v("服务期限（月）")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.fwqx))])]),t._v(" "),s("tr",{directives:[{name:"show",rawName:"v-show",value:!!t.formData.xmmc,expression:"!!formData.xmmc"}]},[s("th",[t._v("合同编号")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.htbh))]),t._v(" "),s("th",[t._v("合同金额（元）")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.htje))])]),t._v(" "),"tz"==t.type?s("tr",[s("th",{staticClass:"before-require"},[t._v("停滞到")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{size:"mini",type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:t.formData.tzrq,callback:function(e){t.$set(t.formData,"tzrq",e)},expression:"formData.tzrq"}})],1)]):t._e(),t._v(" "),"cq"==t.type&&t.formData.xmmc?s("tr",[s("th",[t._v("停滞到")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[t._v("\n\t\t\t\t\t\t"+t._s(t.xmInfo.tzsj)+"\n\t\t\t\t\t")])]):t._e(),t._v(" "),"tz"==t.type?s("tr",[s("th",[t._v("上传附件")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[s("uploadFile",{attrs:{istb:t.isClearFile},on:{handleUploadFile:t.handleUploadFile}})],1)]):t._e(),t._v(" "),s("tr",[s("th",{staticClass:"before-require",staticStyle:{"vertical-align":"top"}},[t._v("详情")]),t._v(" "),s("td",{attrs:{colspan:"3"}},[s("div",{attrs:{id:"summernote"}})])])]),t._v(" "),s("div",{staticClass:"pd-10",attrs:{"text-right":""}},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleCommit}},[t._v("确定")]),t._v(" \n\t\t\t\t"),s("el-button",{attrs:{size:"small"},on:{click:t.handleCancel}},[t._v("取消")])],1)])]),t._v(" "),s("el-dialog",{attrs:{title:"选择项目",visible:t.dialogQuestionVisible,"close-on-click-modal":!1,width:"800px",top:"30px","append-to-body":""},on:{"update:visible":function(e){t.dialogQuestionVisible=e}}},[s("div",{staticStyle:{padding:"10px"}},[s("itemChoose",{attrs:{isCq:"cq"==t.type},on:{handleEdit:t.handleEdit}})],1)])],1)},staticRenderFns:[]};var o=function(t){s("iLwf")},n=s("VU/8")(a.a,i,!1,o,"data-v-66617c9f",null);e.a=n.exports},iLwf:function(t,e){},pLTP:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("XYEa"),i=s("0dLS"),o={data:function(){return{show:!1,smShow:!1,reverse:!1,activities:[],lcList:[],xmInfo:{},type:""}},mounted:function(){this.getProjectStopVO(),this.listWorkFlowNodes(),this.logs()},methods:{handleCommitTzOrCq:function(t){var e=this,s={},a="";"tz"==this.type?(s.xmbh=t.xmbh,s.tzsj=t.tzrq,s.fjData=t.fjData,s.sm=t.sm):(s.xmbh=t.xmbh,s.sm=t.sm),s.wid=this.$route.query.wid,a="tz"==this.type?this.API.restartProjectStopProgress:this.API.restartProjectRestartProgress,this.$post(a,s).then(function(t){"success"==t.state?(e.$message({message:"提交成功",type:"success"}),e.show=!1,e.getProjectStopVO(),e.listWorkFlowNodes(),e.logs()):e.$message({message:t.msg,type:"error"})})},handleApproval:function(t){var e=this;"pass"==t?this.$confirm("是否确定审批通过?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.agreeOrreject("pass")}).catch(function(){}):this.smShow=!0},handleCommitSm:function(t){this.agreeOrreject("reject",t)},handleApply:function(t,e){this.type=t,this.show=!0},agreeOrreject:function(t,e){var s=this;this.$post("pass"==t?this.API.agree:this.API.reject,{wid:this.$route.query.wid,lcwid:this.xmInfo.dqlcwid,sm:e}).then(function(e){"success"==e.state?(s.$message({message:"审批结果已提交",type:"success"}),"pass"!=t&&(s.smShow=!1),s.getProjectStopVO(),s.listWorkFlowNodes(),s.logs()):s.$message({message:e.msg,type:"error"})})},getProjectStopVO:function(){var t=this;this.$get(this.API.getProjectStopVO,{wid:this.$route.query.wid}).then(function(e){"success"==e.state?t.xmInfo=e.data:t.$message({message:e.msg,type:"error"})})},listWorkFlowNodes:function(){var t=this;this.$get(this.API.listWorkFlowNodes,{wid:this.$route.query.wid}).then(function(e){"success"==e.state?t.lcList=e.data:t.$message({message:e.msg,type:"error"})})},logs:function(){var t=this;this.$get(this.API.logs,{wid:this.$route.query.wid}).then(function(e){"success"==e.state?t.activities=e.data?e.data:[]:t.$message({message:e.msg,type:"error"})})}},components:{tzDialog:a.a,smDialog:i.a}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pd-10 projectStagnation"},[s("div",{staticClass:"pannelPaddingBg-10"},[s("div",[s("h5",[t._v("流程节点")]),t._v(" "),s("br"),t._v(" "),s("el-steps",{attrs:{"finish-status":"success",simple:""}},t._l(t.lcList,function(t,e){return s("el-step",{key:e,attrs:{status:1==t.zt?"process ":2==t.zt?"success":3==t.zt?"error":"wait",title:t.lcjdmc+"("+t.clrxm+")"}})}))],1),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"mg-12 table_grid"},[s("h5",{staticClass:"mg-12"},[t._v("详情内容")]),t._v(" "),s("table",[s("tr",[s("th",[t._v("项目编号")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmbh))]),t._v(" "),s("th",[t._v("项目名称")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmmc))]),t._v(" "),s("th",[t._v("学校")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xx))])]),t._v(" "),s("tr",[s("th",[t._v("申请人")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.fqrxm))]),t._v(" "),s("th",[t._v("申请类别")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.mc))]),t._v(" "),s("th",[t._v("整体状态")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmztzt))])]),t._v(" "),s("tr",[s("th",[t._v("状态")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.zt_display))]),t._v(" "),s("th",[t._v("当前流程")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.dqlc))]),t._v(" "),s("th",[t._v("当前流程状态")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.dqlczt_display))])]),t._v(" "),s("tr",[s("th",[t._v("客户经理")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.khjl))]),t._v(" "),s("th",[t._v("项目经理")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmjl))]),t._v(" "),s("th",[t._v("甲方责任人")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.jfzrr))])]),t._v(" "),s("tr",[s("th",[t._v("合同金额（元）")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.htje))]),t._v(" "),s("th",[t._v("项目类别")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.xmlb))]),t._v(" "),s("th",[t._v("合同编号")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.htbh))])]),t._v(" "),s("tr",[s("th",[t._v("合同性质")]),t._v(" "),s("td",[t._v(t._s(t.xmInfo.htxz))])])])]),t._v(" "),s("div",{staticClass:"file_list"},[s("p",{staticClass:"mg-12 filter-weight"},[t._v("附件列表")]),t._v(" "),t.xmInfo.files?s("p",t._l(t.xmInfo.files,function(e){return s("a",{attrs:{href:t.API.downloadFile+"?fjId="+e.fjbh,target:"_blank"}},[t._v(t._s(e.fjmc))])})):s("p",{attrs:{"text-center":""}},[t._v("暂无附件")])]),t._v(" "),s("div",{staticClass:"file_list mg-12"},[s("span",{staticClass:"filter-weight"},[t._v("停滞截止日期：")]),t._v(" "),s("span",[t._v(t._s(t.xmInfo.tzsj))])]),t._v(" "),s("div",{staticClass:"file_list"},[s("p",{staticClass:"mg-12 filter-weight"},[t._v(t._s(1==t.xmInfo.lx?"停滞详情:":"重启详情:"))]),t._v(" "),s("div",{domProps:{innerHTML:t._s(t.xmInfo.sm)}})]),t._v(" "),s("el-divider"),t._v(" "),s("div",[s("h5",{staticClass:"mg-12"},[t._v("流程日志")]),t._v(" "),s("div",{staticClass:"block pd-10"},[s("div",{staticClass:"radio",attrs:{colcenter:""}},[s("span",{staticClass:"filter-weight"},[t._v("排序：")]),t._v(" "),s("el-radio-group",{model:{value:t.reverse,callback:function(e){t.reverse=e},expression:"reverse"}},[s("el-radio",{attrs:{label:!1}},[t._v("正序")]),t._v(" "),s("el-radio",{attrs:{label:!0}},[t._v("倒序")])],1)],1),t._v(" "),t.activities.length?s("el-timeline",{attrs:{reverse:t.reverse}},t._l(t.activities,function(e,a){return s("el-timeline-item",{key:a,attrs:{type:"primary",timestamp:e.cjsj,placement:"top"}},[s("el-card",[s("div",{attrs:{colcenter:""}},[s("h6",[t._v(t._s(e.czmc))]),t._v("\n\t\t\t\t\t\t\t\t　\n\t\t\t\t\t\t\t\t"),s("div",{directives:[{name:"show",rawName:"v-show",value:(1==t.xmInfo.canOper||1==t.xmInfo.canRestart)&&a==t.activities.length-1,expression:"(xmInfo.canOper == 1 || xmInfo.canRestart == 1) && index == activities.length - 1"}]},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.xmInfo.canOper,expression:"xmInfo.canOper == 1"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){t.handleApproval("pass")}}},[t._v("审批通过")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.xmInfo.canOper,expression:"xmInfo.canOper == 1"}],attrs:{type:"danger",size:"mini"},on:{click:function(e){t.handleApproval("reject")}}},[t._v("审批不通过")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.xmInfo.canRestart&&1==t.xmInfo.lx,expression:"xmInfo.canRestart == 1 && xmInfo.lx == 1"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){t.handleApply("tz".xmInfo)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t重启项目停滞\n\t\t\t\t\t\t\t\t\t")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.xmInfo.canRestart&&2==t.xmInfo.lx,expression:"xmInfo.canRestart == 1 && xmInfo.lx == 2"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){t.handleApply("cq",t.xmInfo)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t重启项目重启\n\t\t\t\t\t\t\t\t\t")])],1)]),t._v(" "),s("br"),t._v(" "),s("div",{domProps:{innerHTML:t._s(e.cznr)}})])],1)})):t._e(),t._v(" "),t.activities.length?t._e():s("p",{attrs:{"text-center":""}},[t._v("暂无内容")])],1)])],1),t._v(" "),s("tzDialog",{attrs:{show:t.show,type:t.type,xmData:t.xmInfo},on:{"update:show":function(e){t.show=e},handleCommit:t.handleCommitTzOrCq}}),t._v(" "),s("smDialog",{attrs:{show:t.smShow},on:{"update:show":function(e){t.smShow=e},handleClickSure:t.handleCommitSm}})],1)},staticRenderFns:[]};var r=s("VU/8")(o,n,!1,function(t){s("sN19")},"data-v-e0bc4342",null);e.default=r.exports},sN19:function(t,e){}});
//# sourceMappingURL=24.dc67dc1d400c6cb0f3d5.js.map